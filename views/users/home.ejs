<body class="g-sidenav-show   bg-gray-100">

  <%- include('navbar.ejs') %>
    <!-- End Navbar -->
    <div class="container-fluid py-4" style="min-height: 92vh; display: flex; flex-direction: column;" >

      <h4 class="text-light p-3"> <strong>Welcome, <%= user.name  %> !</strong></h4>

      <div class="row">

        <div class="col-xl-6 col-sm-12 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-8">
                  <div class="numbers">
                    <p class="text-sm mb-0 text-uppercase font-weight-bold">Allocated Hostel</p>
                    <h5 class="font-weight-bolder">
                      <%= user.hostel_allocated.hostel_name %>
                    </h5>
                  </div>
                </div>
                <div class="col-4 text-end">
                  <div class="icon icon-shape bg-gradient-danger shadow-danger text-center rounded-circle">
                    <i class="ni ni-world text-lg opacity-10" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-2 col-sm-12 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-8">
                  <div class="numbers">
                    <p class="text-sm mb-0 text-uppercase font-weight-bold">Registration No</p>
                    <h5 class="font-weight-bolder">
                      <%= user.reg_no %>
                    </h5>
                  </div>
                </div>
                <div class="col-4 text-end">
                  <div class="icon icon-shape bg-gradient-dark shadow-dark text-center rounded-circle">
                    <i class="ni ni-money-coins text-lg opacity-10" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-2 col-sm-12 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-8">
                  <div class="numbers">
                    <p class="text-sm mb-0 text-uppercase font-weight-bold">Room No</p>
                    <h5 class="font-weight-bolder">
                      <% if(user.hostel_allocated.room_no===0) {%>
                        NA
                        <% } else if(user.hostel_allocated.room_no !=='undefined' ) { %>
                          <%= user.hostel_allocated.room_no %>
                            <% } else{ %>
                              NA
                              <% } %>

                    </h5>
                  </div>
                </div>
                <div class="col-4 text-end">
                  <div class="icon icon-shape bg-gradient-success shadow-success text-center rounded-circle">
                    <i class="ni ni-paper-diploma text-lg opacity-10" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-2 col-sm-12 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-8">
                  <div class="numbers">
                    <p class="text-sm mb-0 text-uppercase font-weight-bold">Warden</p>
                    <h5 class="font-weight-bolder">
                      <% if (warden=='None' ) { %>
                        NA
                        <% } else { %>
                          <%= warden.name %>
                            <% } %>
                    </h5>
                  </div>
                </div>
                <div class="col-4 text-end">
                  <div class="icon icon-shape bg-gradient-warning shadow-warning text-center rounded-circle">
                    <i class="ni ni-cart text-lg opacity-10" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>


      <% if (user.payment_status==="NA" && user.hostel_allocated.hostel_name !=="NA" ) { %>
        <div class="row mt-4">

          <div class="col-xl-4 col-sm-12 mb-xl-0 mb-4">
          </div>

          <div class="col-xl-4 col-sm-12 mb-xl-0 mb-4">
            <div class="card">
              <div class="card-body p-3">
                <div class="row">
                  <div class="col" style="text-align: center;">
                    <div class="numbers">
                      <h5 class="font-weight-bolder">
                        <a href="/payment" class="text-danger">You have not made your payment. Please proceed to make
                          your payment by clicking here.</a>
                      </h5>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-xl-4 col-sm-12 mb-xl-0 mb-4">
          </div>

        </div>

        <% } %>
          <div class="row mt-4">

            <% if(user.hostel_allocated.hostel_name !=='NA' ) { %>
              <div class="col-lg-6 mb-lg-0 mb-4 d-flex">
                <div class="card mt-4 flex-fill">
                  <div class="table-responsive p-0">
                    <div class="card-header pb-0">
                      <h6>Hostel Details</h6>
                    </div>

                    <div class="card-body">
                      <table class="table" width="70%">
                        <tbody class="text-start">

                          <tr>
                            <td>
                              <h6>Name</h6>
                            </td>
                            <td>
                              <%= hostel.name %>
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <h6>Address</h6>
                            </td>
                            <td>
                              <%= hostel.address %>
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <h6>Contact</h6>
                            </td>
                            <td>
                              <%= warden.phone %>
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <h6>Type</h6>
                            </td>
                            <td>
                              <%= hostel.type %>
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <h6>capacity</h6>
                            </td>
                            <td>
                              <%= hostel.capacity %>
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <h6>Vacancy</h6>
                            </td>
                            <td>
                              <%= hostel.vacancy %>
                            </td>
                          </tr>

                          <tr>

                          </tr>
                        </tbody>
                      </table>
                    </div>

                  </div>

                </div>
              </div>

              <div class="col-lg-6 mb-lg-0 mb-4 d-flex">
                <div class="card mt-4 flex-fill" style="overflow: hidden;">
                  <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel"
                    style="height: 400px;">
                    <div class="carousel-inner">
                      <div class="carousel-item active">
                        <img src="/hostelImages/<%= user.hostel_allocated.hostel_name %>.jpg" class="d-block w-100 img-fluid" alt="...">
                      </div>
                      
                    </div>
                    <!-- <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions"
                      data-bs-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions"
                      data-bs-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Next</span>
                    </button> -->
                  </div>
                </div>
              </div>

              <div class="mt-4"></div>

              <div class="col-lg-6 mb-lg-0 mb-4">
                <div class="card ">
                  <div class="card-header pb-0 p-3">
                    <div class="d-flex justify-content-between">
                      <h6 class="mb-2">Recent Complaints</h6>
                    </div>
                  </div>
                  <div class="table-responsive p-0">
                    <table class="table align-items-center mb-0">
                      <% if (complaints.length ) { %>
                        <% let mini=Math.min(4, complaints.length) %>
                          <thead>
                            <tr>
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Title</th>
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">
                                Submitted
                                by</th>
                              <th
                                class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                Registration No</th>
                              <!-- <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Description</th> -->
                              <th
                                class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                Status</th>

                            </tr>
                          </thead>

                          <tbody>

                            <% for(let i=0; i<mini; i++) { %>
                              <tr>
                                <td>
                                  <div class="d-flex px-2 py-1">

                                    <div class="d-flex flex-column justify-content-center">
                                      <h6>
                                        <%= complaints[i].title %>
                                      </h6>

                                    </div>

                                  </div>
                                </td>
                                <td>
                                  <h6 class="d-flex flex-column justify-content-center">
                                    <%= complaints[i].submittedBy %>
                                  </h6>
                                  <p class="text-xs text-secondary mb-0"></p>
                                </td>
                                <td class="align-middle text-center">
                                  <h6 class="d-flex flex-column justify-content-center">
                                    <%= complaints[i].regNo %>
                                  </h6>
                                </td>
                                <!-- <td class="align-middle text-center" >                      
                          <h6 class="text-secondary text-xs font-weight-bold" ><%#= complaint.description  %></h6>
                        </td> -->

                                <td class="align-middle text-center">
                                  <h5 class="text-xs font-weight-bold mb-0">
                                    <h6>
                                      <%= complaints[i].status %>
                                    </h6>
                                  </h5>


                                </td>

                              </tr>


                              <% } %>

                                <tr class="text-center">
                                  <td colspan="100%">
                                    <a type="button" href="/my-complaints" class="btn btn-dark">View
                                      All</a>
                                  </td>
                                </tr>

                                <% } else { %>
                                  <p class="p-3">No Complaints to show!!!</p>
                                  <% } %>



                          </tbody>
                    </table>

                  </div>
                </div>
              </div>

              <div class="col-lg-6 mb-lg-0 mb-4">
                <div class="card ">
                  <div class="card-header pb-0 p-3">
                    <div class="d-flex justify-content-between">
                      <h6 class="mb-2">Recent Leaves</h6>
                    </div>
                  </div>
                  <div class="table-responsive p-0">
                    <table class="table align-items-center mb-0">
                      <% if(leaves.length){ %>
                        <% let mini2=Math.min(4, leaves.length) %>
                          <thead>
                            <tr>
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                Registration No
                              </th>
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Submitted
                                by
                              </th>
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">From</th>
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">To</th>
                              <!-- <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Description</th> -->
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Status
                              </th>

                            </tr>
                          </thead>

                          <tbody>

                            <% for(let i=0; i<mini2; i++) { %>
                              <tr>
                                <td>
                                  <div class="d-flex px-2 py-1">

                                    <div class="d-flex flex-column justify-content-start">
                                      <h6>
                                        <%= leaves[i].reg_no %>
                                      </h6>

                                    </div>

                                  </div>
                                </td>
                                <td>
                                  <h6 class="d-flex flex-column justify-content-start">
                                    <%= leaves[i].stud_name %>
                                  </h6>
                                  <p class="text-xs text-secondary mb-0"></p>
                                </td>
                                <td class="align-middle text-start">
                                  <h6 class="d-flex flex-column justify-content-start">
                                    <%= leaves[i].from %>
                                  </h6>
                                </td>
                                <td class="align-middle text-start">
                                  <h6 class="d-flex flex-column justify-content-start">
                                    <%= leaves[i].to %>
                                  </h6>
                                </td>
                                <!-- <td class="align-middle text-center" >                      
                          <h6 class="text-secondary text-xs font-weight-bold" ><%#= complaint.description  %></h6>
                        </td> -->

                                <td class="align-middle text-center">
                                  <h5 class="text-xs font-weight-bold mb-0">
                                    <h6>
                                      <%= leaves[i].status %>
                                    </h6>
                                  </h5>


                                </td>

                              </tr>


                              <% } %>

                                <tr class="text-center">
                                  <td colspan="100%">
                                    <a type="button" href="/leaves" class="btn btn-dark">View
                                      All</a>
                                  </td>
                                </tr>

                                <% } else { %>
                                  <p class="p-3">No Leaves to show!!!</p>
                                  <% } %>



                          </tbody>
                    </table>

                  </div>
                </div>
              </div>

              <% } %>


            <% if(user.hostel_allocated.hostel_name==='NA' ) { %>
              <div class="col-lg-4">
                <div class="card mt-4">
                  <div class="card-body">
                    <h5 class="card-title">Guide for Hostel Allocation</h5>
                    <p class="card-text">Get Started by providing the details in the link below.</p>
                    <a href="/apply-hostel" class="btn btn-dark">Start</a>
                  </div>
                </div>
              </div>
              <div class="col-lg-4">
                <div class="card mt-4">
                  <div class="card-body">
                    <h5 class="card-title">Hostel Rules and Regulations</h5>
                    <p class="card-text">Display hostel rules and regulations</p>
                    <a href="https://drive.google.com/file/d/1wnVCnp54AqV7SeN_Jl4FeANOpb19hrBB/view?usp=sharing"
                      class="btn btn-dark">View Rules</a>
                  </div>
                </div>
              </div>
              <div class="col-lg-4">
                <div class="card mt-4">
                  <div class="card-body">
                    <h5 class="card-title">Explore Hostels</h5>
                    <p class="card-text">Explore </p>
                    <a href="/hostels-list" class="btn btn-dark">Explore</a>
                  </div>
                </div>
              </div>
              <div class="col-lg-12">
                <div class="card mt-4">
                  <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                          data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                          What is the Hostel Allocation Process?
                        </button>
                      </h2>
                      <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                        data-bs-parent="#accordionExample">
                        <div class="accordion-body text-dark">
                          <strong>In order to apply for a Hostel, you have to submit your details on the form by
                            clicking <a href="/apply-hostel">here</a>. The form is open only for a specified
                            duration. After applying, the admin will allocate rooms to each.
                        </div>
                      </div>
                    </div>
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                          data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                          What are the criteria based on which a student is allocated to a hostel?
                        </button>
                      </h2>
                      <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                        data-bs-parent="#accordionExample">
                        <div class="accordion-body text-dark">
                          <strong>The student is allocated a Hostel based on his percentage, gender, availability of
                            rooms and Department quota.
                        </div>
                      </div>
                    </div>
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                          data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                          How to submit a complaint? And who will address it?
                        </button>
                      </h2>
                      <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree"
                        data-bs-parent="#accordionExample">
                        <div class="accordion-body text-dark">
                          <strong>A user can submit a complaint by filling in this <a href="/complaints">form</a>.
                            The warden of the hostel is responsible for addressing all the complaints.
                        </div>
                      </div>

                    </div>

                    <div class="accordion-item">
                      <h2 class="accordion-header" id="headingFour">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                          data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                          What is the cost of accommodation for staying in the hostel?
                        </button>
                      </h2>
                      <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour"
                        data-bs-parent="#accordionExample">
                        <div class="accordion-body text-dark">
                          <strong>The cost for staying in a single bed in the hostel is 4000 per year, which covers
                            all-inclusive expenses such as electricity bills, food, accommodation, and more.
                        </div>
                      </div>

                    </div>

                    <div class="accordion-item">
                      <h2 class="accordion-header" id="headingFive">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                          data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                          How many beds are there in each room?
                        </button>
                      </h2>
                      <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive"
                        data-bs-parent="#accordionExample">
                        <div class="accordion-body text-dark">
                          <strong>The number of beds per room can vary from one to four at max.
                        </div>
                      </div>

                    </div>

                  </div>
                </div>

              </div>

              <% } %>
          </div>


          
    </div>
    <footer class="footer mt-auto ">
      <div class="container-fluid">
        <div class="row align-items-center justify-content-lg-between">
          <div class="col-lg-6 mb-lg-0 mb-4">
            <div class="copyright text-center text-sm text-muted text-lg-start">
              &copy; 2023 Hostel Management System. All rights reserved.
            </div>
          </div>
          <div class="col-lg-6">
            <ul class="nav nav-footer justify-content-center justify-content-lg-end">
              <li class="nav-item">
                <a href="https://www.linkedin.com/in/bhupen-basumatary/" target="_blank" class="text-secondary me-xl-4 me-4">
                  <span class="text-lg fab fa-linkedin"></span>
                </a>
              </li>
              <li class="nav-item">
                <a href="https://twitter.com/bhupenb3" target="_blank" class="text-secondary me-xl-4 me-4">
                  <span class="text-lg fab fa-twitter"></span>
                </a>
              </li>
              <li class="nav-item">
                <a href="https://bbhupen.medium.com" target="_blank" class="text-secondary me-xl-4 me-4">
                  <span class="text-lg fab fa-medium"></span>
                </a>
              </li>
              <li class="nav-item">
                <a href="https://github.com/bbhupen" target="_blank" class="text-secondary me-xl-4 me-4">
                  <span class="text-lg fab fa-github"></span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    </main>
    <!--   Core JS Files   -->
    <script src="/assets/js/core/popper.min.js"></script>
    <script src="/assets/js/core/bootstrap.min.js"></script>
    <script src="/assets/js/plugins/perfect-scrollbar.min.js"></script>
    <script src="/assets/js/plugins/smooth-scrollbar.min.js"></script>
    <script src="/assets/js/plugins/chartjs.min.js"></script>
    

    <script>
      var win = navigator.platform.indexOf('Win') > -1;
      if (win && document.querySelector('#sidenav-scrollbar')) {
        var options = {
          damping: '0.5'
        }
        Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
      }
    </script>



    <!-- Github buttons -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Control Center for Soft Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="/assets/js/argon-dashboard.min.js?v=2.0.4"></script>
</body>